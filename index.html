<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Heart Bound</title>
<style>
body {margin:0; overflow:hidden; font-family:Arial,sans-serif; background:#111;}
canvas {display:block; margin:auto;}
#menu {
  position:absolute; inset:0;
  background:#111;
  display:flex; flex-direction:column;
  align-items:center; justify-content:center;
  color:white;
}
#menu h1 {font-size:70px; margin-bottom:140px;}
.heart {
  width:220px; height:200px;
  background:red; position:relative;
  transform:rotate(-45deg); cursor:pointer;
  margin-bottom:20px;
}
.heart::before, .heart::after {
  content:""; position:absolute; width:220px; height:200px;
  background:red; border-radius:50%;
}
.heart::before {top:-110px;}
.heart::after {left:110px;}
.heart span {
  position:absolute; transform:rotate(45deg);
  top:85px; left:60px;
  font-size:36px; font-weight:bold; color:white;
}
button {margin-top:10px; font-size:18px; padding:10px 20px; cursor:pointer;}
#highScore {color:#fff; margin-top:10px; font-size:18px;}
#rules {display:none; position:absolute; inset:0; background:#222; color:#fff; padding:20px; overflow:auto;}
#rules h2 {margin-top:0;}
#closeRules {margin-top:20px; padding:10px 20px; cursor:pointer;}
</style>
</head>
<body>

<div id="menu">
<h1>HEART BOUND</h1>
<div class="heart" id="playBtn"><span>PLAY</span></div>
<button id="rulesBtn">Rules</button>
<div id="highScore">High Score: 0</div>
</div>

<div id="rules">
<h2>How to Play</h2>
<p>Jump over the blocks by pressing SPACE.</p>
<p>Collect the bubble by standing still on it for +50 points.</p>
<p>Each block gives +100 points. Avoid hitting blocks! You have 3 lives.</p>
<p>Fireworks appear at 1000 points. Keep going to see special messages at 5000 and 10000 points.</p>
<button id="closeRules">Close</button>
</div>

<canvas id="game" width="900" height="450"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

// Game state
let gameRunning=false, score=0, lives=3, timeCounter=0, won=false, highScore=localStorage.getItem('heartBoundHigh') || 0;

// Player
const player = {x:120, y:0, vy:0, jumping:false, width:10, height:40};

// Obstacle
const obstacle = {x:900, y:0, w:50, h:40, speed:5, passed:false};

// Bubble
const bubble = {x:1400, y:260, r:18, collected:false};

// Fireworks
let fireworks=[];

// Messages
let msg1000=false, msg5000=false, msg10000=false;

// Menu & rules
const playBtn=document.getElementById("playBtn");
const rulesBtn=document.getElementById("rulesBtn");
const closeRules=document.getElementById("closeRules");
const rulesDiv=document.getElementById("rules");
const highScoreDiv=document.getElementById("highScore");

playBtn.addEventListener("click", startGame);
rulesBtn.addEventListener("click", ()=>rulesDiv.style.display="block");
closeRules.addEventListener("click", ()=>rulesDiv.style.display="none");

document.addEventListener("keydown", e=>{
  if(e.code==="Space" && !player.jumping){ player.vy=-14; player.jumping=true; }
});

function startGame(){
  document.getElementById("menu").style.display="none";
  gameRunning=true;
  score=0; lives=3; timeCounter=0;
  obstacle.x=900; obstacle.passed=false; bubble.x=1400; bubble.collected=false;
  won=false; msg1000=false; msg5000=false; msg10000=false;
  player.y=playerOnGrassY();
  obstacle.speed = 3 + Math.random()*3; // random initial speed
  obstacle.y = playerOnGrassY() + player.height - obstacle.h; // Lowered obstacle to sit on grass
  requestAnimationFrame(loop);
}

// Player Y position on grass
function playerOnGrassY(){ return 350 - player.height; }

// Background
function drawBackground(){
  ctx.fillStyle="#6ec6ff"; ctx.fillRect(0,0,900,450);
  // Rainbow
  const colors=["red","orange","yellow","green","blue","purple"];
  colors.forEach((c,i)=>{
    ctx.strokeStyle=c; ctx.lineWidth=7;
    ctx.beginPath();
    ctx.arc(750,400,120-i*10,Math.PI,2*Math.PI);
    ctx.stroke();
  });
  // Grass
  ctx.fillStyle="#4caf50"; ctx.fillRect(0,350,900,100);
  // Dirt under grass
  ctx.fillStyle="#8B4513"; ctx.fillRect(0,390,900,60);
  // Clouds
  ctx.fillStyle="#fff";
  [[200,80],[230,80],[260,80],[600,60],[630,60],[660,60]].forEach(([cx,cy])=>{
    ctx.beginPath();
    ctx.arc(cx,cy,30,0,Math.PI*2); ctx.fill();
  });
}

// Draw stick figure
function drawPlayer(){
  const x=player.x, y=player.y;
  ctx.strokeStyle="#000"; ctx.lineWidth=3;
  ctx.beginPath();
  ctx.moveTo(x,y); ctx.lineTo(x,y-30); ctx.stroke(); // body
  ctx.beginPath();
  ctx.moveTo(x,y-20); ctx.lineTo(x-10,y-10);
  ctx.moveTo(x,y-20); ctx.lineTo(x+10,y-10); ctx.stroke(); // arms
  ctx.beginPath();
  ctx.moveTo(x,y); ctx.lineTo(x-10,y+20);
  ctx.moveTo(x,y); ctx.lineTo(x+10,y+20); ctx.stroke(); // legs
  ctx.beginPath();
  ctx.arc(x,y-40,8,0,Math.PI*2); ctx.stroke(); // head
}

// Draw lives as hearts
function drawLives(){
  for(let i=0;i<lives;i++){
    ctx.fillStyle="red"; 
    ctx.beginPath();
    ctx.arc(25+i*30,25,7,0,Math.PI*2);
    ctx.arc(33+i*30,25,7,0,Math.PI*2); ctx.fill();
  }
}

// Fireworks
function createFirework(){
  let x=Math.random()*800+50, y=Math.random()*200+50;
  const colors=["red","orange","yellow","green","blue","purple"];
  for(let i=0;i<20;i++){
    fireworks.push({x:x,y:y,dx:(Math.random()-0.5)*6,dy:(Math.random()-0.5)*6,color:colors[Math.floor(Math.random()*colors.length)],life:60});
  }
}

function drawFireworks(){
  fireworks.forEach(f=>{
    ctx.fillStyle=f.color;
    ctx.beginPath(); ctx.arc(f.x,f.y,3,0,Math.PI*2); ctx.fill();
    f.x+=f.dx; f.y+=f.dy; f.life--;
  });
  fireworks = fireworks.filter(f=>f.life>0);
}

// Game over
function gameOver(){
  gameRunning=false;
  if(score>highScore){localStorage.setItem('heartBoundHigh',score);}
  ctx.fillStyle="black"; ctx.font="60px Arial";
  ctx.fillText("GAME OVER",280,200);
  ctx.font="30px Arial";
  ctx.fillText("Refresh to Restart",320,260);
  highScoreDiv.innerText = "High Score: " + Math.max(score,highScore);
}

// Loop
function loop(){
  if(!gameRunning) return;
  ctx.clearRect(0,0,900,450);
  drawBackground();

  // Gravity
  player.vy+=0.8; player.y+=player.vy;
  if(player.y>=playerOnGrassY()){player.y=playerOnGrassY(); player.vy=0; player.jumping=false;}

  // Obstacles
  obstacle.x-=obstacle.speed;
  if(obstacle.x<-50){obstacle.x=900; obstacle.passed=false; obstacle.speed = 3 + Math.random()*4;}
  if(!obstacle.passed && obstacle.x<player.x){score+=100; obstacle.passed=true;}

  // Collision
  if(player.x+5>obstacle.x && player.x-5<obstacle.x+obstacle.w && player.y+player.height>obstacle.y){
    lives--; obstacle.x=900;
    if(lives<=0) return gameOver();
  }

  // Bubble
  bubble.x-=3;
  ctx.strokeStyle="white"; ctx.beginPath(); ctx.arc(bubble.x,bubble.y,bubble.r,0,Math.PI*2); ctx.stroke();
  ctx.fillStyle="black"; ctx.fillText("+50",bubble.x-12,bubble.y+5);
  if(!bubble.collected && Math.abs(player.x-bubble.x)<25 && Math.abs(player.y-bubble.y)<30 && !player.jumping){
    score+=50; bubble.collected=true; bubble.x=1400;
  }

  // Draw player and obstacle
  drawPlayer();
  // Grass block obstacle
  ctx.fillStyle="#4caf50"; ctx.fillRect(obstacle.x,obstacle.y,obstacle.w,15); // grass top
  ctx.fillStyle="#8B4513"; ctx.fillRect(obstacle.x,obstacle.y+15,obstacle.w,obstacle.h-15); // dirt below

  drawLives();
  ctx.fillStyle="black"; ctx.font="20px Arial"; ctx.fillText("Score: "+score,760,30);

  // Messages
  if(score>=1000 && !msg1000){msg1000=true; createFirework();}
  if(msg1000 && score<=1100){ctx.fillStyle="red"; ctx.font="50px Arial"; ctx.fillText("I LOVE YOU â¤ï¸",260,150); ctx.fillStyle="gold"; ctx.font="40px Arial"; ctx.fillText("ðŸ‘‘ WINNER ðŸ‘‘",300,220);}
  if(score>=5000 && !msg5000){msg5000=true;}
  if(msg5000 && score<=5100){ctx.fillStyle="blue"; ctx.font="40px Arial"; ctx.fillText("Keep Going!",320,180);}
  if(score>=10000 && !msg10000){msg10000=true;}
  if(msg10000 && score<=10100){ctx.fillStyle="purple"; ctx.font="40px Arial"; ctx.fillText("Thank you for everything â¤ï¸",180,180);}

  if(won){drawFireworks();}

  requestAnimationFrame(loop);
}

// Display high score on menu
highScoreDiv.innerText = "High Score: " + highScore;
</script>
</body>
</html>
